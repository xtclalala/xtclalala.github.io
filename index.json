[{"categories":["cyber","intelligence","ransomware"],"content":"play ransomware on intelligence","date":"2023-06-06","objectID":"/cyber-intelligence-play-ransomware/","tags":["威胁情报"],"title":"Play Ransomware","uri":"/cyber-intelligence-play-ransomware/"},{"categories":["cyber","intelligence","ransomware"],"content":"简介 PLAY 勒索软件活动至少在2022年7月中旬以来一直处在活跃阶段。直至2022年9月至少有五份 PLAY 勒索软件的赎金单被上传至VirusTotal。2022年8月阿根廷科尔多瓦司法机构是目前有记录的最早的受害者。 ","date":"2023-06-06","objectID":"/cyber-intelligence-play-ransomware/:0:1","tags":["威胁情报"],"title":"Play Ransomware","uri":"/cyber-intelligence-play-ransomware/"},{"categories":["cyber","intelligence","ransomware"],"content":"攻击后果 使用play后缀的加密文件，赎金单的内容为play和电子邮件地址。使用RSA-AES混合密码系统来加密文件。 ","date":"2023-06-06","objectID":"/cyber-intelligence-play-ransomware/:0:2","tags":["威胁情报"],"title":"Play Ransomware","uri":"/cyber-intelligence-play-ransomware/"},{"categories":["cyber","intelligence","ransomware"],"content":"暗网地址 http://mbrlkbtq5jonaqkurjwmxftytyn2ethqvbxfu4rgjbkkknndqwae6byd.onion/index.php k7kg3jqxang3wh7hnmaiokchk7qoebupfgoik6rha6mjpzwupwtj25yd.onion ","date":"2023-06-06","objectID":"/cyber-intelligence-play-ransomware/:0:3","tags":["威胁情报"],"title":"Play Ransomware","uri":"/cyber-intelligence-play-ransomware/"},{"categories":["network"],"content":"Icmp协议的报文格式，可以做什么","date":"2023-03-14","objectID":"/protocol-icmp/","tags":["protocol"],"title":"Icmp","uri":"/protocol-icmp/"},{"categories":["network"],"content":"什么是ICMP？ 因特网控制报文协议ICMP(Internet Control Message Protocol)是一个差错报文协议，是TCP/IP协议簇中的重要子协议，被IP或TCP/UDP层使用，属于网络协议。主要用于在主机和路由器之间传递控制消息，用于报告主机是否可达、路由是否可用。对于收集各种网络信息、诊断和排除各种网络故障以及用户数据的传递具有至关重要的作用。 ","date":"2023-03-14","objectID":"/protocol-icmp/:0:0","tags":["protocol"],"title":"Icmp","uri":"/protocol-icmp/"},{"categories":["network"],"content":"为什么需要ICMP？ 数据传输过程中，IP提供尽力而为的服务，只做将数据包发送到目的主机的工作，并不对目的主机是否收到数据包进行验证，无法进行流量控制和差错控制。为了更有效的转发IP数据包和提高数据包交付成功的情况，可以使用ICMP。当数据包传输出现问题时，主机或设备向上层协议报告差错情况和提供有关异常情况，使上层协议可以利用自己的差错控制程序进行控制，从而保证服务质量。 ","date":"2023-03-14","objectID":"/protocol-icmp/:1:0","tags":["protocol"],"title":"Icmp","uri":"/protocol-icmp/"},{"categories":["network"],"content":"ICMP包头报文格式 ICMP差错报文不会产生差错报文，但ICMP查询报文会产生差错报文，防止ICMP出现无限产生和传递 目的地址是广播地址或多播地址，一个网段的最后一个地址是广播地址 源地址不能为零地址，环回地址，广播地址或多播地址 type 8bit icmp消息类型 code 8bit icmp消息类型的子类型 checksum 16bit icmp报文校验和 type code 描述 查询/差错 0 echo 响应 0 echo 响应报文 查询 3 目的不可达 0 目标网络不可达 差错 1 目标主机不可达 差错 2 目标协议不可达 差错 3 目标端口不可达 差错 4 要求分段DF flag标志 差错 5 源路由失败 差错 6 未知的目标网络 差错 7 未知的目标主机 差错 8 源主机隔离 差错 9 禁止访问的网络 差错 10 禁止访问的主机 差错 11 对特定的TOS网络不可达 差错 12 对特定的TOS网络不可达 差错 13 由于过滤网络流量被禁止 差错 14 主机越权 差错 15 优先权终止生效 差错 5 重定向 0 重定向网络 差错 1 重定向主机 差错 2 基于TOS的网络重定向 差错 3 基于TOS的主机重定向 差错 8 echo 请求 0 echo 请求 查询 9 路由器通知 0 路由通告 查询 10 路由器请求 0 路由器的发现、选择、请求 查询 11 ICMP超时 0 TLL超时报文 差错 1 分片重组超时报文 差错 12 参数问题 0 IP报首部参数错误 差错 1 丢失必要选项 差错 2 不支持长度 差错 13 时间戳请求 0 时间戳请求报文 查询 14 时间戳应答 0 时间戳应答报文 查询 15 信息请求 0 信息请求报文 查询 16 信息应答 0 信息应答报文 查询 ","date":"2023-03-14","objectID":"/protocol-icmp/:2:0","tags":["protocol"],"title":"Icmp","uri":"/protocol-icmp/"},{"categories":["network"],"content":"ICMP可以做什么？ ","date":"2023-03-14","objectID":"/protocol-icmp/:3:0","tags":["protocol"],"title":"Icmp","uri":"/protocol-icmp/"},{"categories":["network"],"content":"Ping 用于检测IPv4和IPv6网络设备的工具，通过ICMP的包头信息来确认 ","date":"2023-03-14","objectID":"/protocol-icmp/:3:1","tags":["protocol"],"title":"Icmp","uri":"/protocol-icmp/"},{"categories":["network"],"content":"泛洪攻击 基于ICMP的泛洪攻击，攻击者在短时间内向目标设备发送大量ICMP虚假报文，导致目标设备忙于应付无用报文 针对带宽的DOS攻击 攻击者发送伪造的ICMP请求报文，交换机、路由器等网络设备需要CPU响应无用报文，导致占用宽带和CPU资源 端口扫描攻击 攻击者发送端口扫描报文，交换机需要回应大量的ICMP目的不可达报文，攻击者可以获取设备开启的端口 针对主机的DOS攻击 在paylod中构造64KB导致内存分配错误，导致TCP/IP堆栈崩溃，致使被攻击主机宕机 ","date":"2023-03-14","objectID":"/protocol-icmp/:3:2","tags":["protocol"],"title":"Icmp","uri":"/protocol-icmp/"},{"categories":["network"],"content":"攻击防范 报文限速 ICMP报文限速，通过端口限速、VLAN限速、全局限速 报文合法性检查 TLL为0，ICMP类型为15、16、17的报文，进行丢弃 不响应不可达报文 直接丢弃端口不可达或网络不可达报文 ","date":"2023-03-14","objectID":"/protocol-icmp/:3:3","tags":["protocol"],"title":"Icmp","uri":"/protocol-icmp/"},{"categories":["cyber"],"content":"第一章：了解应急响应 网络安全是指网络系统的硬件、软件及其系统中的数据受到保护，不因偶发的或恶意的原因而遭到破坏、更改、泄露，保证系统连接的可靠性、稳定性。面对各种新奇怪异的病毒和不计其数的安全漏洞，建立有效的安全应急体系并使之不断完善，已成为信息化社会发展的必然需求。 网络安全应急响应是指针对已发生或可能发生的安全事件进行监控、分析、协调、处理、保护资产安全。网络安全应急响应主要目的是让群众对网络安全有所认识和准备，以便在遇到突发网络安全事件时做到有序应对和妥善处理。 ","date":"2023-03-13","objectID":"/cyber-services-emergency/:1:0","tags":["应急响应"],"title":"应急响应-从理论到实战","uri":"/cyber-services-emergency/"},{"categories":["cyber"],"content":"第二章：应急响应流程 ","date":"2023-03-13","objectID":"/cyber-services-emergency/:2:0","tags":["应急响应"],"title":"应急响应-从理论到实战","uri":"/cyber-services-emergency/"},{"categories":["cyber"],"content":"一、响应 对事件进行判断 常见网络安全应急响应场景：勒索病毒、挖矿木马、WebShell、网页篡改、Dos攻击、数据泄露、流量劫持 信息收集 信息收集的目的：流量分析、日志分析、可疑进程的内存、失陷系统镜像、恶意样本、资产收集、资产相关漏洞测试报告、防护设备日志。 ","date":"2023-03-13","objectID":"/cyber-services-emergency/:2:1","tags":["应急响应"],"title":"应急响应-从理论到实战","uri":"/cyber-services-emergency/"},{"categories":["cyber"],"content":"二、阻断 所谓阻断即为：关闭服务、拔网线 切断网络 切断网络是为观察病毒行为、观察流量特征、阻断对内通信、阻断对外连接。 阻断传播 传播包括：感染（对内传播），外联（对外传播） 感染：进程注入/迁移，第三方软件感染，服务传播（ftp/ssh爆破等） 外联：挖矿行为、外联攻击、c2通信 阻断传播可以从代码、网络层面进行。 例：排查软件是否被劫持、查找内存马、是否通过网络传播病毒。 隔离核心资产/隔离受害主体（群体） 不论任何情况必须保证沦陷方的隔离，达到保护现场、收集攻击者信息，原则为：保护、弊害、不损害。 ","date":"2023-03-13","objectID":"/cyber-services-emergency/:2:2","tags":["应急响应"],"title":"应急响应-从理论到实战","uri":"/cyber-services-emergency/"},{"categories":["cyber"],"content":"三、分析 分析的前提是提炼，提炼出关键信息分析，而提炼的前提是熟悉攻击手法。 日志、流量、样本 日志主要注意内容为时间、动作、结果；威胁行为的开始时间、结束时间，威胁行为具体的功能、造成的结果等。 流量主要注意内容为请求状态码、交互过程、数据合理性；接口中数据的传输是否符合正常使用数据。 样本主要注意内容为样本的启动方式、伪装方式、作用。 行为分析\u0026还原攻击过程 从行为出发，还原攻击过程，推演攻击过程。 行为分析主要依据：启动项、启动脚本、进程、内存等。 ","date":"2023-03-13","objectID":"/cyber-services-emergency/:2:3","tags":["应急响应"],"title":"应急响应-从理论到实战","uri":"/cyber-services-emergency/"},{"categories":["cyber"],"content":"响应基本命令 系统排查 win 服务、驱动：msinfo32 系统版本/主机名：systeminfo linux cpu信息：lscpu 操作系统信息：uname -a 操作系统版本信息：cat /proc/version 所有载入系统的模块信息：lsmod 启动项 win 启动项详细信息：msconfig linux 启动项脚本文件存放处：ls -alt /etc/init.d 存放启动项脚本存储路径的文件：cat /etc/rc.local 任务计划 win 在powershell中查看系统所有任务计划信息： Get-ScheduledTask 查看任务计划信息：schtasks linux 查看当前计划任务：crontab -l 查看etc目录下所有的任务计划文件：ls /etc/cron* 防火墙 win 防火墙信息查看：netsh advfirewall firewall show rule linux 查看路由转换：iptables -L 系统进程 win 所有进程，查询加载恶意dll的进程：tasklist /m 查看指定网络连接：netstat -ano | findstr “内容名称” linux 查看cpu占用高的进程：top 查看指定pid执行程序：ls -alt /proc/pid 结束进程： kill -9 pid 文件痕迹排查 win 检查浏览器、下载文件、cookie信息 linux 查找当天新增sh文件：find / -ctime 0 -name “*.sh” 日志排查 win 在事件查看器中找事件id为4625（登陆错误）、4720（创建用户）、1102（清理审计日志） linux 常规日志文件存在在：/var/log 排查WebShell linux 根据webshell特征对文件进行排查 find / -type f -name “*.jsp” | xargs grep “exec(” find / -type f -name “*.php” | xargs grep “eval(” find / -type f -name “*.asp” | xargs grep “execute(” find / -type f -name “*.aspx” | xargs grep “eval(” ","date":"2023-03-13","objectID":"/cyber-services-emergency/:2:4","tags":["应急响应"],"title":"应急响应-从理论到实战","uri":"/cyber-services-emergency/"},{"categories":["network"],"content":"什么是ARP？ ARP(Address Resolution Protocol，地址解析协议)可以将IP解析成对应的Mac地址。 ","date":"2023-03-12","objectID":"/protocol-arp/:1:0","tags":["protocol"],"title":"ARP","uri":"/protocol-arp/"},{"categories":["network"],"content":"ARP报文格式 目的Mac 以太网首部 48bit 发送arp请求报文时，该字段为广播的Mac地址0xffff-ffff-ffff 源Mac 48bit 源Mac 帧类型 16bit arp请求和应答报文，该字段为0x0806 硬件类型 ARP 16bit 以太网类型，该字段为1 协议类型 16bit 发送方要映射的协议地址类型，对于IP地址，该字段的值为0x0800 硬件地址长度 8bit arp请求或应答报文，该字段为6 协议地址长度 8bit arp请求或应答报文，该字段为4 OP 16bit arp操作类型，1为arp请求报文，2为应答报文 源Mac 48bit Mac地址和以太网帧的源Mac地址相同 源IP 32bit 源IP 目的Mac 48bit 发送arp请求报文，该字段为0x0000-0000-0000 目的IP 32bit 目的IP ","date":"2023-03-12","objectID":"/protocol-arp/:2:0","tags":["protocol"],"title":"ARP","uri":"/protocol-arp/"},{"categories":["network"],"content":"ARP可以做什么？ 利用arp可以对当前网段进行设备嗅探。 ","date":"2023-03-12","objectID":"/protocol-arp/:3:0","tags":["protocol"],"title":"ARP","uri":"/protocol-arp/"},{"categories":null,"content":"当然我也在扯淡","date":"2023-03-01","objectID":"/about/","tags":null,"title":"关于我","uri":"/about/"},{"categories":null,"content":"热爱计算机的祥子，妄图想用技术改变自身生活，但发现没有技术，只有销售… ","date":"2023-03-01","objectID":"/about/:0:0","tags":null,"title":"关于我","uri":"/about/"}]